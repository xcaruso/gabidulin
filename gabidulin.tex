\documentclass[a4paper]{llncs}

\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{color}
\usepackage[english]{babel}
\usepackage{microtype}

\definecolor{todo}{rgb}{0.9,0,0}

\author{Caruso Xavier \and Durand Amaury}
\institute{Institute : to do}

\def\todo#1{{\color{todo} #1}}

\title{Gabidulin Codes}

\newcommand{\ZZ}{\mathbb Z}
\newcommand{\FF}{\mathbb F}

\newcommand{\id}{\textrm{\rm id}}
\newcommand{\End}{\textrm{\rm End}}
\newcommand{\GL}{\textrm{\rm GL}}
\newcommand{\ev}[1]{\textrm{\rm ev}_{#1}}
\renewcommand{\mod}{\,\%\,}

\newcommand{\rgcd}{\textsc{rgcd}}
\newcommand{\llcm}{\textsc{llcm}}

\newcommand{\bc}{\textbf{c}}
\newcommand{\bg}{\textbf{g}}
\newcommand{\Gab}{\textrm{\rm Gab}}
\newcommand{\wH}{w_{\textrm{\rm H}}}
\newcommand{\wrH}{w_{\textrm{\rm rH}}}
\newcommand{\drH}{d_{\textrm{\rm rH}}}
\newcommand{\good}{\textrm{\rm good}}

\begin{document}
\maketitle

\section{Introduction}

In 1985, Gabidulin Ernst introduced a Reed-Solomon-like code 
construction in rank metric. This Gabidulin code class use linearised 
polynomial concept. In 2013, Wachter-Zeh Antonia proposed efficient 
implementations of operations with linearized polynomials as well as an 
equivalent of Gao's algorithm for decoding Gabidulin code. Following 
years, Boucher Delphine and Ulmer Felix have worked on skew coding 
theory using Ore's polynomials and they have generalized many code class 
like BCH or Reed-Solomon. In 2015, Robert Gwezheneg expanded Gabidulin 
construction to skew-polynomials including the characteristic zero.

\todo{Présenter ce qu'il y a dans cet article. Le faire à la fin 
pour le détail.}

\section{Ore polynomials}

Throughout this article, we use the following notation: $K$ is a field, 
$\theta : K \to K$ be a ring homomorphism and $\partial : K \to K$ be a 
$\theta$-derivation, i.e. an additive mapping such that $\partial(ab) = 
\theta(a)\partial(b) + \partial(a)b$ for all $a,b \in K$.

We shall denote by $F$ the subfield of $K$ consisting of elements
$a$ such that $\theta(a) = a$ and $\partial(a) = 0$. 
\textbf{We will always assume that the extension $K/F$ is finite.}
This implies in particular that $\theta$ has finite order and thus
is bijective.

%Ore polynomials are a non-commutative generalization of classical 
%polynomials. They are usefull in semi-linear algebra and in the 
%resolution of differential equation. They intervene in the same way as 
%classical polynomials in linear algebra, like endomorphism polynomial or 
%characteristic polynomial. Let's start with a definition

\begin{definition}[Ore polynomial ring]
The ring of Ore polynomials $K[X; \theta, \partial]$ is the ring 
whose elements are polynomials in $X$ over $A$ endowed with the usual 
addition and with the multiplication defined by the rule:
$$X \times a = \theta(a)X + \partial(a), \quad \forall a \in A.$$
%
%An element of this ring is called Ore polynomial.
%
%When $\partial = 0$, Ore ring is called skew polynomial ring and when 
%$A$ is a finite field and $\theta$ the Frobenius morphism, Ore ring is 
%called linearized polynomial ring.
\end{definition}

\begin{example}
\todo{Donner les exemples :
(1)~$\FF_{q^m}[X,\theta,0]$ avec $\theta(x) = x^q$ et
(2)~$\FF_p(t)[X,\id,\frac d{dt}]$.}
\end{example}

The notion of degree extends \emph{verbatim} to Ore polynomials: if $P = 
\sum a_iX^i$ is an Ore polynomial, its degree is the largest integer $i$ 
for which $a_i \neq 0$.
Besides, one can prove the existence of a right Euclidean division for 
Ore polynomials: if $A, B \in K[X;\theta,\partial]$ with $B \neq 0$, 
there exist unique $Q, R \in K[X;\theta,\partial]$ with $A = QB+R$ and 
$\deg R < \deg B$. This has the usual consequences: the noncommutative
ring $K[X;\theta,\partial]$ is left-principal, right \textsc{gcd}s and
left \textsc{lcm}s are well defined and can be computed by Euclidean
algorithm. 
Similarly, left Euclidean divisions, left \textsc{gcd}s and right 
\textsc{lcm}s do exist (since our general assumptions imply that
$\theta$ is bijective).

\medskip

\noindent
\textit{Notation:}
In what follows, we will denote by $A \mod B$ the remainder in the 
right division of $A$ by $B$.

\todo{Rappeler des choses sur le centre de $K[X,\theta,\partial]$:
c'est un anneau de polynôme sur $F$ engendré par un polynôme $Z(X)$
de degre $[K:F]$ (défini à une constante additive dans $F$ près).}

\begin{example}
\todo{Dire ce qu'est le polynôme $Z(X)$ pour les exemples (1) et (2) ; 
en fait, à chaque fois, on peut prendre $Z(X) = X^{[K:F]}$.}
\end{example}

\begin{example}
Let $K = GF_7(t)$ the fraction field of univariate polynomial on the 
field at 7 elements. Let $\partial = \frac{\partial}{\partial t}$ a 
classic polynomial derivation. In this article, we will interesting in 
this red thread example : $K[X, \id, \partial] = GF_7(t)[X, \id, 
\frac{\partial}{\partial t}]$, and $F$ is the subfield $F = \{x \in 
GF_7(t) \ | \ \frac{\partial x}{\partial t} = 0\} = GF_7(t^7)$.
\end{example}

\subsubsection*{Pseudo-linear morphisms.}

Another important notion is that of pseudo-linear morphisms. It is 
defined as follows:

\begin{definition}[Pseudo-linear morphism]
Let $M$ and $N$ be two vector spaces over $K$.
A \emph{pseudo-linear morphism} $u : M\to N$ is a map verifying 
$u(ax) = \theta(a)u(x) + \partial(a)x$ for all $a \in K$ and $x \in M$.
\end{definition}

We observe that any pseudo-linear morphism is \emph{a fortiori}
$F$-linear (where $F$ is defined at the beginning of this section).

Pseudo-linear morphisms are relevant in the context of Ore polynomials 
because the Ore multiplication reflects the composition rule of 
pseudo-linear morphisms. More precisely, given a pseudo-linear 
endomorphism $u : M \to M$ and a Ore polynomial $P = \sum_i a_i X^i \in 
K[X;\theta,\partial]$, one defines $P(u) = \sum_i a_i u^i$. One then 
easily checks that $P(u) \circ Q(u) = (PQ)(u)$ where the multiplication 
on the right hand size is the Ore multiplication. In other words, 
denoting by $\End_F(M)$ the ring of $F$-linear maps from $M$ to itself, 
the ``evaluation'' mapping
$$\ev{u} : \quad K[X;\theta,\partial] \to \End_F(M), \quad
P(X) \mapsto P(u)$$
is a ring homomorphism for any pseudo-linear endomorphism $u$.

The case where $M$ is $K$ itself deserves particular attention.
Indeed, we first observe that evaluation is then closely related to
Euclidean division thanks to the formula:
\begin{equation}
\label{eq:evanddiv}
\textstyle \ev{u}(P)(a) = 
a \cdot P \mod \big(X - \frac{u(a)}{a}\big)
\end{equation}
for any pseudo-linear endomorphism $u$ of $K$, any $P \in K[X;\theta,
\partial]$ and any $a \in K$. Second, we have a complete classification
of pseudo-linear endomorphisms of $K$.

\begin{proposition}
The pseudo-linear endomorphisms of $K$ are exactly the maps of
the form $\partial + c\theta$ with $c \in K$.
\end{proposition}

\begin{proof}
It is easily checked that $\partial + c\theta$ is pseudo linear
for all $c\in A$. Conversely, let $u$ be a pseudo-linear morphism.
Set $g = u - \partial$. It is easily checked that $g$ is 
$\theta$-semi linear, i.e. $g(ab) = \theta(a) g(b)$ for all $a, b 
\in K$. Applying this with $b = 1$ and letting $c = g(1)$, we end
up with $g = c \theta$ and so $u = \partial + c\theta$. \qed
\end{proof}

In what follows, we will often use the notation $\ev c$ in place of 
$\ev{\partial + c \theta}$.

\paragraph{Main properties of the $\ev c$'s.}

We denote by $K_\good$ the subset of $K$ consisting of elements $c$ for 
which $\partial + c\theta$ is not of the form $a{\cdot}\id$ with $a \in 
F$.

\begin{proposition}
\label{prop:evc}
For all $c \in K_\good$, the ring homomorphism $\ev{c}$ is surjective
and its kernel is a principal ideal generated by $Z(X) - N(c)$
for some element $N(c) \in F$.
\end{proposition}

\begin{example}
For $c = 0 \in GF_7$, $\ker (\ev 0)$ is generated by the polynomial $X^7$. Indeed, we have $\ev 0 (X^7) = (\frac{\partial}{\partial t})^7$ and so, for all $P \in F = GF_7(t^7)$, $\ev 0 (P) = 0$.
\end{example}


\begin{remark}
The function $N$ defined by Proposition \ref{prop:evc} above is not 
canonical since it depends on the choice of the constant coefficient 
of $Z(X)$. Two different choices lead to functions $N$ and $N'$ such
that $N' = N + a$ for some constant $a \in F$.
\end{remark}

\todo{Dire ce qu'est la fonction $N$ pour les exemples (1) et (2).}

\begin{definition}
\label{def:equiv}
Let $c_1, c_2 \in K_\good$.
We say that $c_1$ and $c_2$ are \emph{equivalent} if
$\ker \ev{c_1} = \ker \ev{c_2}$ or, equivalently, $N(c_1) = N(c_2)$.
\end{definition}

Using Noether--Skolem Theorem, one can prove that $c_1$ and $c_2$ are 
equivalent if and only if there exists $a \in K$, $a \neq 0$ such that 
$c_1 a = c_2 \theta(a) + \partial(a)$. In particular, we notice that the 
equivalence class of $c \in K$ is exactly the image of $x \mapsto 
\frac{(\partial + c\theta)(x)} x$.

\todo{Détailler la condition ci-dessus sur les exemples (1) et (2).}

\begin{proposition}
\label{prop:evbc}
Let $\bc = (c_1, \ldots, c_m)$ be a tuple of $m$ pairwise non-equivalent 
elements of $K_\good$.
Then the ring homomorphism:
$$\ev \bc : \quad K[X;\theta,\partial] \to \End_F(M)^m, \quad
P \mapsto (\ev{c_1}(P), \ldots, \ev{c_m}(P))$$
is surjective and its kernel is the ideal generated by
$\prod_{i=1}^m (Z(X) - N(c_i))$.
\end{proposition}

\begin{proof}
Let $P \in \ker \ev\bc$. From the fact that $\ev{c_i}(P)$ vanishes,
we deduce that $P$ is a multiple of $Z(X) - N(c_i)$. We know moreover
by assumption that the $N(c_i)$'s are pairwise distinct. It follows
from this that:
$$\llcm(Z(X)-N(c_1), \ldots, Z(X)-N(c_m)) = 
\prod_{i=1}^m (Z(X) - N(c_i)).$$
Therefore $\prod_{i=1}^m (Z(X) - N(c_i))$ must divide $P$ and the
assertion about the kernel is proved. The surjectivity of $\ev\bc$
follows by comparing dimensions.
\end{proof}

\section{Generalized Gabidulin codes}

\todo{Écrire une introduction}

We keep the notations of the previous section. In particular, we recall 
that $K_\good$ is the subset of $K$ consisting of elements $c$ for which 
$\partial + c\theta$ is not of the form $a{\cdot}\id$ with $a \in F$.

\subsubsection*{Setting.}

Throughout this section, we fix a positive integer $m$. We consider a 
family $\bc = (c_1, \ldots, c_m)$ of $m$ elements of $K_\good$ which are 
pairwise non-equivalent in the sense of Definition \ref{def:equiv}.
Moreover, for each $i \in \{1,\ldots,m\}$, we pick a positive integer
$n_i$ together with a family $\bg_i = (g_{i,1}, \ldots, g_{i,n_i})$ of 
$F$-linearly independant elements of $K$. The latter condition obviously
implies that $n_i \leq [K:F]$ for all $i$.
We set $n = n_1 + \ldots + n_m$ and we fix an extra positive integer
$k < n$.
To all these data, we associate the $F$-linear mapping:
$$\begin{array}{rcl}
\gamma_{k,\bc,\bg} : \, K[X;\theta,\partial]_{<k} & \longrightarrow 
 & K^{n_1} \times K^{n_2} \times \cdots \times K^{n_m} \smallskip \\
P(X) & \mapsto 
 & \big(\ev{c_1}(P)(g_{1,1}), \ev{c_1}(P)(g_{1,2}), \ldots, \ev{c_1}(P)(g_{1,n_1}), \\
&& \phantom{\big(}\ev{c_2}(P)(g_{2,1}), \ev{c_2}(P)(g_{2,2}), \ldots, \ev{c_2}(P)(g_{2,n_2}), \\
&& \phantom{\big(}\ldots, \\
&& \phantom{\big(}\ev{c_m}(P)(g_{m,1}), \ev{c_m}(P)(g_{m,2}), \ldots, \ev{c_m}(P)(g_{m,n_m})\big)
\end{array}$$
Thanks to Eq.~\eqref{eq:evanddiv}, the mapping $\gamma_{k,\bc,\bg}$
can be rewritten in terms of Euclidean divisions. More precisely,
for $1 \leq i \leq m$ and $1 \leq j \leq n_i$, letting:
\begin{equation}
\label{eq:aij}
a_{i,j} = \frac{(\partial + c_i\theta)(g_{i,j})}{g_{i,j}}.
\end{equation}
we have $\ev{c_i}(g_{i,j}) = g_{i,j} \cdot P \mod (X - a_{i,j})$.
It is worth remarking that the assumption we made on the $c_i$'s
and $g_{i,j}$'s can be translated easily on the $a_{i,j}$, as shown
by the next lemma.

\begin{lemma}
\label{lem:llcmaij}
With the above notations, the Ore polynomial
$$L = \llcm((X - a_{i,j})_{1 \leq i \leq m,\,1 \leq j \leq n_i})$$
has degree $n$.
\end{lemma}

\begin{proof}
Assume by contradiction that $\deg L < n$.
For each $i \in \{1,\ldots,m\}$, pick some additional $g_{i,j}$'s
for $n_i < j \leq r$ in order to form a basis $(g_{i,j})_{1 \leq j 
\leq r}$ of $K$ over $F$. We define the corresponding $a_{i,j}$'s
accordingly using \eqref{eq:aij}. 
Set $L' = \llcm(X - a_{i,j})_{1 \leq i \leq m,\,1 \leq j \leq r})$.
From
$L' = \llcm(L, (X - a_{i,j})_{1 \leq i \leq m,\,n_i < j \leq r}$,
we obtain 
$$\deg L' \leq \deg L + \sum_{i=1}^m (r - n_i) < rm.$$
Moreover, for any given $i \in \{1,\ldots, m\}$, the linear mapping 
$\ev{c_i}(L')$ vanishes on $g_{i,j}$ for all $j \in \{1, \ldots,r\}$. 
Since they form a basis of $K$ over $F$, we get $\ev{c_i}(L') = 0$.
Therefore $L'$ lies in the kernel of the ring homomorphism $\ev\bc =
(\ev{c_1}, \ldots, \ev{c_m})$. By Proposition \ref{prop:evbc},
$L'$ has to be a multiple of $\prod_{i=1}^m (Z(X) - N(c_i))$,
which is a contradiction since the latter polynomial has degree $rm > 
\deg L'$.
\end{proof}

\todo{Donner des exemples. Et pour chacun, calculer les $a_{i,j}$
correspondants.}

\subsubsection*{Definition and first properties.}

We are now ready to define Gabidulin codes in the extended framework
discussed in the introduction of this section.

\begin{definition}%[Generalized Gabidulin Code]
With the previous notations, the \emph{generalized Gabidulin code} 
$\Gab_{k,\bc,\bg}$ associated to $\bc$ and $\bg$ is the image of 
$\gamma_{k,\bc,\bg}$.
\end{definition}

\begin{example}
To complete the red thread example, we'll considere the Gabidulin Code : $Gab_0[7,3,g]$ where $g = (t^i)$ for $i \in \{0, \dots, 6\}$. It is of length  $7$ anf dimension $3$.
\end{example}

It is well known that the relevant distance for Gabidulin codes is 
not the Hamming distance but the rank distance. In the context of 
generalized Gabidulin codes introduced above, we shall need another
distance which is a mixture between Hamming and rank distance. It is
defined as follows.

\begin{definition}%[Rank weight]
Let $x = (x_{i,j})_{1 \leq i \leq m, \; 1 \leq j \leq n_i} \in
K^{n_1} \times K^{n_2} \times \cdots \times K^{n_m}$.
The \emph{rank-Hamming weight} of $x$ is:
$$\wrH(x) = 
\sum_{i=1}^m \dim_F \big< x_{i,1}, x_{i,2}, \ldots, x_{i,{m_i}} \big>_F.$$
Given $x, y \in K^{n_1} \times K^{n_2} \times \cdots \times K^{n_m}$, 
the {rank-Hamming distance} between $x$ and $y$ is $\drH(x,y) = 
\wrH(x-y)$.
\end{definition}

\begin{remark}
The weight $\wrH$ is finer that the usual Hamming weight in the 
sense that, for all $x \in K^{n_1} \times \cdots \times K^{n_m}$, 
we have $\wrH(x) \leq \wH(x)$ if $\wH$ denotes the Hamming weight.
\end{remark}

\todo{Faire remarquer que si $m = 1$, on retrouve les codes de 
Gabidulin classiques (et les codes de Gabidulin généralisés de Robert)
avec la distance rang classique.
Au contraire, si $\theta = \id$ et $\partial = 0$ (et donc $F = K$),
on retrouve les codes de Reed--Solomon avec la distance de Hamming
usuelle.}

\begin{proposition}
The generalized Gabidulin code $\Gab_{k,\bc,\bg}$ has length $n$,
dimension $k$ and minimal distance $d = n - k + 1$.
\end{proposition}


\begin{proof}
Let $x \in \Gab_{k,\bc,\bg}$ be a nonzero codeword. Let $P \in 
K[X;\theta,\partial]$ with $\deg P < k$ and $\gamma_{k,\bc,\bg}(P) = x$.
Let $E_i$ denote the $F$-span of $g_{i,1}, \ldots, g_{i,n_i}$. By
definition of the rank-Hamming weight, we know that
$\wrH(x) = \sum_{i=1}^m \dim_F \ev{c_i}(P)(E_i)$.
Set $\delta_i = \dim_F \ker \ev{c_i}(P)$. By the rank-nullity
theorem, $\delta_i + \dim_F \ev{c_i}(P)(E_i) \geq n_i$. By summing
up on $i$, we get:
\begin{equation}
\label{eq:sumdeltai}
\sum_{i=1}^m \delta_i \geq n - \wrH(x).
\end{equation}
For $i \in \{1,\ldots,d\}$, let $(h_{i,1}, \ldots, h_{i,\delta_i})$
be a basis of $\ker \ev{c_i}(P)$. 
Set moreover $b_{i,j} = \frac{(\partial + c_i\theta)(h_{i,j})}{b_{i,j}}$
and $L = \llcm((X - b_{i,j})_{1 \leq i \leq m, \, 1 \leq j \leq \delta_i})$.
By copying the proof of Lemma \ref{lem:llcmaij}, we end up with
$\deg L = \sum_{i=1}^m \delta_i$. Furthermore since $\ev{c_i}(P)$
vanishes on all $h_{i,j}$'s, the Ore polynomial $P$ has to be a 
multiple of $L$. Thus $k > \deg P \geq \sum_{i=1}^m \delta_i$.
Comparing with \eqref{eq:sumdeltai}, we find $k > n - \wrH(x)$,
\emph{i.e.} $\wrH(x) \geq n - k + 1$.
We have then proved that the minimal distance of $\Gab_{k,\bc,\bg}$
is at least $n - k + 1$.
The inequality in the other direction, together with the fact that
$\Gab_{k,\bc,\bg}$ has dimension $k$, now follow from Singleton bound.
\end{proof}

\begin{example}
Our example code, $Gab_0[7,3,g]$ have a minimal rank distance $5$ and it can correct an error of weight $2$. 
\end{example}

\subsubsection*{Decoding generalized Gabidulin codes.}

To decode Gabidulin codes, we have a generalized Gao algorithm. Let $Gab_c[n,k,g]$ a gabidulin code and $b = \{b_1, \dots, b_n\} \in K^n$ a received vector. To decode $b$ we proceed as follows.

\begin{itemize}
\item Step 0, Annihilator : Find the unique Ore polynomial $G_0$ as $\ev{c}(G_0)(g_i) = 0$ for all $i \in \{1, \dots, n\}$.
\item Step 1, Interpolation : Find the unique Ore polynomial $G_1$ as $\ev{c}(G_1)(g_i) = b_i$ and $\deg(G_1) \leqslant n-1$.
\item Step 2, Partial gcd : Apply the extend Euclidian algorithm to $G_0$ and $G_1$. Stop when the remainder $G$ has degree $< \frac{n+k}{2}$. If we have to this step $uG_0 + vG_1 = G$.
\item Step 3, Long left division : Apply a left division to $G$ by $v$, say $G = vf_1 + r$. If $r =0$ and $\deg(f_1) < k$ then the word is $f_1$ else, that more than $\frac{d-1}{2}$ errors occurred. 
\end{itemize}


\todo{Ajouter un exemple d'application de l'algorithme.}

\section{Implementation}

\todo{\begin{itemize}
\item dire ce qu'on a implémenté
\item donner quelques benchmarks
\end{itemize}}

\end{document}
